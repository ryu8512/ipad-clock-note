<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clock & Memo</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet" />

  <!-- 캐시 방지 메타 태그 -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      background-color: black;
      color: white;
      font-family: 'Orbitron', sans-serif;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }

    #container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      width: 100vw;
    }

    /* 가로 모드 */
    @media (orientation: landscape) {
      #container {
        flex-direction: row;
      }

      #clock-container {
        flex: 7;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      #memo-container {
        flex: 3;
      }

      #time {
        font-size: 12vw;
        font-variant-numeric: tabular-nums;
      }

      #seconds {
        font-size: 4vw;
        vertical-align: baseline;
        font-variant-numeric: tabular-nums;
      }

      #date {
        font-size: 3vw;
        margin-bottom: 10px;
        text-align: center;
      }
    }

    /* 세로 모드 */
    @media (orientation: portrait) {
      #clock-container {
        text-align: center;
        padding: 20px 0;
      }

      #date {
        font-size: 6vw;
        margin-bottom: 10px;
        text-align: center;
      }

      #time {
        font-size: 18vw;
        font-variant-numeric: tabular-nums;
      }

      #seconds {
        display: none;
      }

      #container {
        flex-direction: column;
      }

      #clock-container {
        flex: 3;
      }

      #memo-container {
        flex: 7;
      }
    }

    #memo {
      width: 100%;
      height: 100%;
      font-size: 1.2em;
      background-color: black;
      color: white;
      border: none;
      padding: 10px;
      box-sizing: border-box;
      resize: none;
    }

    #memo:focus {
      outline: none;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="clock-container">
      <div id="date"></div>
      <div>
        <span id="time"></span>
        <span id="seconds"></span>
      </div>
    </div>
    <div id="memo-container">
      <textarea id="memo" placeholder="메모를 입력하세요..."></textarea>
    </div>
  </div>

  <script>
    function updateClock() {
      const now = new Date();
      const time = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
      const seconds = now.toLocaleTimeString('en-GB', { second: '2-digit' });
      const date = now.toLocaleDateString('en-GB', { year: 'numeric', month: 'numeric', day: 'numeric', weekday: 'short' });

      document.getElementById('time').textContent = time;
      document.getElementById('seconds').textContent = seconds;
      document.getElementById('date').textContent = date.replace(/\//g, '.');
    }

    function saveMemo() {
      localStorage.setItem('memo', document.getElementById('memo').value);
    }

    function loadMemo() {
      const saved = localStorage.getItem('memo');
      if (saved !== null) {
        document.getElementById('memo').value = saved;
      }
    }

    document.getElementById('memo').addEventListener('input', saveMemo);

    // 시계 업데이트
    updateClock();
    setInterval(updateClock, 1000);

    // 메모 불러오기
    loadMemo();

    // 강제 새로고침 (홈화면 앱 캐시 우회용)
    if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
      if (!location.href.includes('?t=')) {
        location.href = location.pathname + '?t=' + new Date().getTime();
      }
    }
  </script>
</body>
</html>
